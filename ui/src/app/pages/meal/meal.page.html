<ion-content>
  <ion-header class="ion-no-border">
    <ion-toolbar>
      <img
        src="assets/strawberry.png"
        alt="Home"
        id="logo"
        (click)="navigateTo('')"
      />
    </ion-toolbar>
  </ion-header>

  <div *ngIf="isLoading" class="centered-content">
    <ion-spinner></ion-spinner>
  </div>

  <div *ngIf="errorMessage" class="centered-content">
    <p>{{ errorMessage }}</p>
  </div>

  <div *ngIf="!isLoading && !errorMessage" class="centered-content">
    <h1>{{ nutrients.summary }}</h1>
    <h3>{{ nutrients.calories }} Calories</h3>

    <div style="display: block">
      <canvas
        baseChart
        class="chart"
        [data]="pieChartData"
        [type]="pieChartType"
        [options]="pieChartOptions"
      ></canvas>
    </div>

    <div class="legend-container">
      <div class="legend-item">
        <div class="color-box" style="background-color: #4ca7c8"></div>
        <div class="label">Carbs</div>
      </div>
      <div class="legend-item">
        <div class="color-box" style="background-color: #f3f5eb"></div>
        <div class="label">Fats</div>
      </div>
      <div class="legend-item">
        <div class="color-box" style="background-color: #ff6b6b"></div>
        <div class="label">Proteins</div>
      </div>
    </div>

    <ion-button
      *ngIf="isUserLoggedIn"
      (click)="openDateTimePicker()"
      expand="block"
    >
      Log Food
    </ion-button>
  </div>
</ion-content>

<ion-modal [isOpen]="isDateTimePickerOpen">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-title>Select Date and Time</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="cancelDateTimePicker()">Cancel</ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    <ion-content class="ion-padding">
      <ion-datetime
        presentation="date-time"
        [(ngModel)]="selectedDateTime"
        (ionChange)="dateTimeChanged($event)"
      ></ion-datetime>
      <ion-button expand="block" (click)="confirmDateTime()"
        >Confirm</ion-button
      >
    </ion-content>
  </ng-template>
</ion-modal>
